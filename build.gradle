plugins {
    id 'java'
}

archivesBaseName = 'CommandRepeater'
group 'land.oz.munchkin'
version '1.0.0-SNAPSHOT'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
    maven {
        url "https://hub.spigotmc.org/nexus/content/repositories/snapshots"
    }
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots"
    }
}

dependencies {
    compileOnly "org.spigotmc:spigot-api:1.14.4-R0.1-SNAPSHOT"
    compileOnly 'org.jetbrains:annotations:17.0.0'
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

task makeTest() {
    dependsOn(build)
    doLast {
        copy {
            from "$buildDir/libs/" + archivesBaseName + "-" + version + ".jar"
            into "G:\\Minecraft\\Server\\spigot-1.14.4\\plugins"
        }
        exec {
            workingDir("G:\\Minecraft\\Server\\spigot-1.14.4")
            commandLine = ['cmd', '/C', 'start', 'run.bat']
        }
    }
}
task runServer(type: Exec) {
    dependsOn(makeTest)
    workingDir("G:\\Minecraft\\Server\\spigot-1.14.4")
    commandLine = ['cmd', '/C', 'start', 'run.bat']
}